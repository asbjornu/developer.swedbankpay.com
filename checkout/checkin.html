


<!DOCTYPE html>
<html lang="en-US">

    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="mobile-web-app-capable" content="yes">
        <meta name="theme-color" content="#000">
        <meta name="application-name" content="Swedbank Pay Checkout – Checkin">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
        <meta name="apple-mobile-web-app-title"
            content="Swedbank Pay Checkout – Checkin">
        <meta name="msapplication-TileColor" content="#000">
        <meta name="msapplication-TileImage" content="https://design.swedbankpay.com/v/4.3.0/icons/mstile-144x144.png">
        <meta property="og:type" value="website" />
        
        <meta property="og:url" value="https://developer.swedbankpay.com/checkout/checkin.html" />
        <meta property="og:title" value="Swedbank Pay Checkout – Checkin" />
        <meta name="title" content="Swedbank Pay Checkout – Checkin" />
        
        <meta property="og:description" value="Swedbank Pay Developer Portal" />
        <meta name="description" content="Swedbank Pay Developer Portal" />
        
        <meta property="og:image" value="/assets/img/swedbank-pay-developer-portal.png" />
        <title>Swedbank Pay Checkout – Checkin</title>
        <link rel="stylesheet" href="https://design.swedbankpay.com/v/4.3.0/styles/dg-style.css" />
        <link rel="stylesheet" href="/assets/css/swedbank-pay-design-guide-theme.css" />
        <link rel="stylesheet" href="/assets/css/prism.css" />
        <link rel="shortcut icon" href="https://design.swedbankpay.com/v/4.3.0/icons/favicon.ico">
        <link rel="icon" type="image/png" sizes="16x16" href="https://design.swedbankpay.com/v/4.3.0/icons/favicon-16x16.png">
        <link rel="icon" type="image/png" sizes="32x32" href="https://design.swedbankpay.com/v/4.3.0/icons/favicon-32x32.png">
        <link rel="apple-touch-icon" sizes="57x57"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-57x57.png">
        <link rel="apple-touch-icon" sizes="60x60"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-60x60.png">
        <link rel="apple-touch-icon" sizes="72x72"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-72x72.png">
        <link rel="apple-touch-icon" sizes="76x76"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-76x76.png">
        <link rel="apple-touch-icon" sizes="114x114"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-114x114.png">
        <link rel="apple-touch-icon" sizes="120x120"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-120x120.png">
        <link rel="apple-touch-icon" sizes="144x144"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-144x144.png">
        <link rel="apple-touch-icon" sizes="152x152"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-152x152.png">
        <link rel="apple-touch-icon" sizes="167x167"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-167x167.png">
        <link rel="apple-touch-icon" sizes="180x180"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-180x180.png">
        <link rel="apple-touch-icon" sizes="1024x1024"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-icon-1024x1024.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-320x460.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-640x920.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-640x1096.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-750x1294.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-1182x2208.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-1242x2148.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-748x1024.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-768x1004.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-1496x2048.png">
        <link rel="apple-touch-startup-image"
            media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)"
            href="https://design.swedbankpay.com/v/4.3.0/icons/apple-touch-startup-image-1536x2008.png">
        <link rel="icon" type="image/png" sizes="228x228" href="https://design.swedbankpay.com/v/4.3.0/icons/coast-228x228.png">
        <script src="/assets/js/mermaid.min.js"></script>
        
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
        <script src="/assets/tipuesearch/tipuesearch_content.js"></script>
        <script src="/assets/tipuesearch/tipuesearch_set.js"></script>
        <script src="/assets/tipuesearch/tipuesearch.min.js"></script>
        
    </head>

    <body>
        <div id="designguide">
            <header class="topbar topbar-md-wide designguide-header">
                <button type="button" class="topbar-btn"><i class="material-icons topbar-btn-icon">menu</i></button>
                <a href="https://developer.swedbankpay.com" class="topbar-logo"><img
                        src="https://design.swedbankpay.com/v/4.3.0/img/swedbankpay-logo.svg" alt="logo"></a>
                <nav class="topbar-nav">
                    <div class="topbar-link-container">
                        <button type="button" class="topbar-close"><i class="material-icons">close</i></button>

                        
                        

                        

                        <a 
                            href="/"><span>Home</span></a>

                        
                        
                        <a 
                            href="/checkout/"><span>Checkout</span></a>
                        
                        
                        <a 
                            href="/payments/"><span>Payments</span></a>
                        
                        
                        <a 
                            href="/resources/"><span>Resources</span></a>
                        

                        <div class="topbar-info topbar-link-right">
                            <div class="topbar-info-contact">
                                <a href="https://github.com/SwedbankPay/developer.swedbankpay.com/tree/master/checkout/checkin.md" target="_blank"
                                    rel="noopener noreferrer" title="Edit this page on GitHub">
                                    <svg aria-labelledby="simpleicons-github-icon" role="img" viewBox="0 0 24 24"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <title id="simpleicons-github-icon">Edit this page on GitHub</title>
                                        <path
                                            d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" />
                                    </svg>
                                </a>
                            </div>
                        </div>
                    </div>
                </nav>
            </header>

            <div class="documentation">
                <div class="row">
                    <div class="col-xxl-2 col-md-3">
                        <div class="doc-sidebar">
                            
                            <form class="doc-search" action="/search">
                                <input type="text" class="form-control" name="q" id="tipue_search_input"
                                    placeholder="Search..." autocomplete="off" pattern=".{3,}"
                                    title="At least 3 characters">
                            </form>
                            
                            
                            <nav class="documentation-nav">
                                
                                
                                <div class="nav-group active">
                                    <div class="nav-heading">
                                        <i class="material-icons">keyboard_arrow_right</i>
                                        <span>Checkout</span>
                                    </div>

                                    
                                    <ul>
                                        
                                        
                                        <li><a  href="/checkout/"><span>Introduction</span></a></li>
                                        
                                        
                                        <li><a  aria-current="page" class="active"
                                                 href="/checkout/checkin"><span>Checkin</span></a></li>
                                        
                                        
                                        <li><a  href="/checkout/payment-menu"><span>Payment Menu</span></a></li>
                                        
                                        
                                        <li><a  href="/checkout/capture"><span>Capture</span></a></li>
                                        
                                        
                                        <li><a  href="/checkout/after-payment"><span>After Payment</span></a></li>
                                        
                                        
                                        <li><a  href="/checkout/other-features"><span>Other Features</span></a></li>
                                        
                                    </ul>
                                    
                                </div>
                                
                            </nav>
                            
                        </div>
                    </div>

                    <main class="doc-view col-xxl-10 col-md-9">
                        <div class="doc-container">
                            <h1>Swedbank Pay Checkout – Checkin</h1>
                            <div class="row">
                                <div class="doc-body col-lg-10">
                                    
                                    <div class="jumbotron">
    <p>Swedbank Pay Checkout consists of two parts:
<strong>Checkin</strong> and <strong>Payment Menu</strong>. In the sections that follow you’ll find
examples of the HTTP requests, responses and HTML code you will need to
implement in order to complete the Swedbank Pay Checkout integration. To
finalize Checkout you first have to Checkin. To check in, the payer needs to be
identified.</p>

</div>
      <h2 id="introduction">
        
        
          Introduction <a href="#introduction" class="header-anchor"></a>
        
        
      </h2>

<p>An overview of how the process of identifying the payer through Checkin is
illustrated in the below sequence diagram.</p>

<pre><code class="language-mermaid">sequenceDiagram
    participant Payer
    participant Merchant
    participant SwedbankPay as Swedbank Pay

        rect rgba(238, 112, 35, 0.05)
            note left of Payer: Checkin

    Payer -&gt;&gt;+ Merchant: Start Checkin
    Merchant -&gt;&gt;+ SwedbankPay: POST /psp/consumers
    deactivate Merchant
    SwedbankPay --&gt;&gt;+ Merchant: rel:view-consumer-identification ①
    deactivate SwedbankPay
    Merchant --&gt;&gt;- Payer: Show Checkin on Merchant Page

    Payer -&gt;&gt;+ Payer: Initiate Consumer Hosted View (open iframe) ②
    Payer -&gt;&gt;+ SwedbankPay: Show Consumer UI page in iframe ③
    deactivate Payer
    SwedbankPay -&gt;&gt;- Payer: Consumer identification process
    activate Payer
    Payer -&gt;&gt;+ SwedbankPay: Consumer identification process
    deactivate Payer
    SwedbankPay --&gt;&gt;- Payer: show consumer completed iframe
    activate Payer
    Payer -&gt;&gt; Payer: EVENT: onConsumerIdentified (consumerProfileRef) ④
    deactivate Payer
    end
</code></pre>
    
      <h2 id="checkin-back-end">
        
        
          Checkin Back End <a href="#checkin-back-end" class="header-anchor"></a>
        
        
      </h2>

<p>The payer will be identified with the <code class="language-plaintext highlighter-rouge">consumers</code> resource and will be
persisted to streamline future Payment Menu processes. Payer identification
is done through the <code class="language-plaintext highlighter-rouge">initiate-consumer-session</code> operation.</p>

<p class="code-header"><strong>Request</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nf">POST</span> <span class="nn">/psp/consumers</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">api.externalintegration.payex.com</span>
<span class="na">Authorization</span><span class="p">:</span> <span class="s">Bearer &lt;AccessToken&gt;</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"operation"</span><span class="p">:</span><span class="w"> </span><span class="s2">"initiate-consumer-session"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"language"</span><span class="p">:</span><span class="w"> </span><span class="s2">"sv-SE"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"shippingAddressRestrictedToCountryCodes"</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">"NO"</span><span class="p">,</span><span class="w"> </span><span class="s2">"SE"</span><span class="p">,</span><span class="w"> </span><span class="s2">"DK"</span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table class="table table-striped">
  <thead>
    <tr>
      <th style="text-align: center">Required</th>
      <th style="text-align: left">Property</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: center">✔︎︎︎︎︎</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">operation</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">initiate-consumer-session</code>, the operation to perform.</td>
    </tr>
    <tr>
      <td style="text-align: center">✔︎︎︎︎︎</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">language</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">Selected language to be used in Checkin. Supported values are <code class="language-plaintext highlighter-rouge">nb-NO</code>, <code class="language-plaintext highlighter-rouge">sv-SE</code> and <code class="language-plaintext highlighter-rouge">en-US</code></td>
    </tr>
    <tr>
      <td style="text-align: center">✔︎︎︎︎︎</td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">shippingAddressRestrictedToCountryCodes</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">List of supported shipping countries for merchant. Using ISO-3166 standard.</td>
    </tr>
  </tbody>
</table>

<p>When the request has been sent, a response containing an array of operations that can be acted upon will be returned:</p>

<p class="code-header"><strong>Response</strong></p>

<div class="language-http highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span> <span class="m">200</span> <span class="ne">OK</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/json</span>

<span class="p">{</span><span class="w">
    </span><span class="nl">"token"</span><span class="p">:</span><span class="w"> </span><span class="s2">"7e380fbb3196ea76cc45814c1d99d59b66db918ce2131b61f585645eff364871"</span><span class="p">,</span><span class="w">
    </span><span class="nl">"operations"</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"redirect-consumer-identification"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://ecom.externalintegration.payex.com/consumers/sessions/7e380fbb3196ea76cc45814c1d99d59b66db918ce2131b61f585645eff364871"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"text/html"</span><span class="w">
        </span><span class="p">},</span><span class="w">
        </span><span class="p">{</span><span class="w">
            </span><span class="nl">"method"</span><span class="p">:</span><span class="w"> </span><span class="s2">"GET"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"rel"</span><span class="p">:</span><span class="w"> </span><span class="s2">"view-consumer-identification"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"href"</span><span class="p">:</span><span class="w"> </span><span class="s2">"https://ecom.externalintegration.payex.com/consumers/core/scripts/client/px.consumer.client.js?token=afccf3d0016340620756d5ff3e08f69b555fbe2e45ca71f4bd159ebdb0f00065"</span><span class="p">,</span><span class="w">
            </span><span class="nl">"contentType"</span><span class="p">:</span><span class="w"> </span><span class="s2">"application/javascript"</span><span class="w">
        </span><span class="p">}</span><span class="w">
    </span><span class="p">]</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<table class="table table-striped">
  <thead>
    <tr>
      <th style="text-align: left">Property</th>
      <th style="text-align: left">Type</th>
      <th style="text-align: left">Description</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">token</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">A session token used to initiate Checkout UI.</td>
    </tr>
    <tr>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">operations</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">array</code></td>
      <td style="text-align: left">The array of operation objects to choose from, described in detail in the table below.</td>
    </tr>
    <tr>
      <td style="text-align: left">└➔ <code class="language-plaintext highlighter-rouge">rel</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">The relational name of the operation, used as a programmatic identifier to find the correct operation given the current state of the application.</td>
    </tr>
    <tr>
      <td style="text-align: left">└➔ <code class="language-plaintext highlighter-rouge">method</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">The HTTP method to use when performing the operation.</td>
    </tr>
    <tr>
      <td style="text-align: left">└➔ <code class="language-plaintext highlighter-rouge">contentType</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">The HTTP content type of the target URI. Indicates what sort of resource is to be found at the URI, how it is expected to be used and behave.</td>
    </tr>
    <tr>
      <td style="text-align: left">└➔ <code class="language-plaintext highlighter-rouge">href</code></td>
      <td style="text-align: left"><code class="language-plaintext highlighter-rouge">string</code></td>
      <td style="text-align: left">The target URI of the operation.</td>
    </tr>
  </tbody>
</table>
    
      <h2 id="checkin-front-end">
        
        
          Checkin Front End <a href="#checkin-front-end" class="header-anchor"></a>
        
        
      </h2>

<p>The response from the <code class="language-plaintext highlighter-rouge">POST</code> of consumer information contains a few operations.
The combination of <code class="language-plaintext highlighter-rouge">rel</code>, <code class="language-plaintext highlighter-rouge">method</code> and <code class="language-plaintext highlighter-rouge">contentType</code> should give you a clue how
the operation should be performed.
The <code class="language-plaintext highlighter-rouge">view-consumer-identification</code> operation
and its <code class="language-plaintext highlighter-rouge">application/javascript</code> content type gives us a clue that the
operation is meant to be embedded in a <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> element in an HTML document.</p>

<div class="alert  alert-warning">
    
        
            <i class="material-icons alert-icon">warning</i>
        
    

    
        
            <p>In our example we will focus on using the
                      <code class="language-plaintext highlighter-rouge">view-consumer-identification</code> solution.
                      The <code class="language-plaintext highlighter-rouge">redirect-consumer-identification</code> method redirects
                      the user to Swedbank’s own site to handle the checkin
                      and is used in other implementations.
                      <code class="language-plaintext highlighter-rouge">redirect-consumer-identification</code> <strong>should only be used in
                      test enviroments</strong>. It is not suitable for the production
                      environment as there is no simple way of retrieving the
                      <code class="language-plaintext highlighter-rouge">consumerProfileRef</code>.</p>
        
    
</div>

<p class="code-header"><strong>HTML</strong></p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;!DOCTYPE html&gt;</span>
<span class="nt">&lt;html&gt;</span>
    <span class="nt">&lt;head&gt;</span>
        <span class="nt">&lt;title&gt;</span>Swedbank Pay Checkout is Awesome!<span class="nt">&lt;/title&gt;</span>
    <span class="nt">&lt;/head&gt;</span>
    <span class="nt">&lt;body&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"checkin"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="nt">&lt;div</span> <span class="na">id=</span><span class="s">"payment-menu"</span><span class="nt">&gt;&lt;/div&gt;</span>
        <span class="c">&lt;!-- Here you can specify your own javascript file --&gt;</span>
        <span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"&lt;Your-JavaScript-File-Here&gt;"</span><span class="nt">&gt;&lt;/script&gt;</span>
    <span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</code></pre></div></div>

<div class="alert  alert-neutral">
    
        
            <i class="material-icons alert-icon">info</i>
        
    

    
        
            <p>The Checkin and Payment
Menu components (the two <code class="language-plaintext highlighter-rouge">&lt;iframe&gt;</code> elements) must be separate
(one must not replace the other).</p>
        
    
</div>

<p>In the HTML, you only need to add two <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> elements to place the
check-in and payment menu inside of. The JavaScript will handle the rest when
it comes to handling the check-in and payment menu.</p>

<p class="code-header"><strong>JavaScript</strong></p>

<div class="language-js highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">var</span> <span class="nx">request</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">XMLHttpRequest</span><span class="p">();</span>

<span class="nx">request</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="dl">'</span><span class="s1">load</span><span class="dl">'</span><span class="p">,</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
    <span class="c1">// We will assume that our own backend returns the</span>
    <span class="c1">// exact same as what SwedbankPay returns.</span>
    <span class="kd">var</span> <span class="nx">response</span> <span class="o">=</span> <span class="nx">JSON</span><span class="p">.</span><span class="nx">parse</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">responseText</span><span class="p">);</span>
    <span class="kd">var</span> <span class="nx">script</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">createElement</span><span class="p">(</span><span class="dl">'</span><span class="s1">script</span><span class="dl">'</span><span class="p">);</span>
    <span class="c1">// This assumes that the operations from the response of the POST from the</span>
    <span class="c1">// payment order is returned verbatim from the server to the Ajax:</span>
    <span class="kd">var</span> <span class="nx">operation</span> <span class="o">=</span> <span class="nx">response</span><span class="p">.</span><span class="nx">operations</span><span class="p">.</span><span class="nx">find</span><span class="p">(</span><span class="kd">function</span> <span class="p">(</span><span class="nx">o</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">return</span> <span class="nx">o</span><span class="p">.</span><span class="nx">rel</span> <span class="o">===</span> <span class="dl">'</span><span class="s1">view-consumer-identification</span><span class="dl">'</span><span class="p">;</span>
    <span class="p">});</span>

    <span class="nx">script</span><span class="p">.</span><span class="nx">setAttribute</span><span class="p">(</span><span class="dl">'</span><span class="s1">src</span><span class="dl">'</span><span class="p">,</span> <span class="nx">operation</span><span class="p">.</span><span class="nx">href</span><span class="p">);</span>
    <span class="nx">script</span><span class="p">.</span><span class="nx">onload</span> <span class="o">=</span> <span class="kd">function</span> <span class="p">()</span> <span class="p">{</span>
        <span class="nx">payex</span><span class="p">.</span><span class="nx">hostedView</span><span class="p">.</span><span class="nx">consumer</span><span class="p">({</span>
            <span class="c1">// The container specifies which id the script will look for</span>
            <span class="c1">// to host the checkin component</span>
            <span class="na">container</span><span class="p">:</span> <span class="dl">'</span><span class="s1">checkin</span><span class="dl">'</span><span class="p">,</span>
            <span class="na">onConsumerIdentified</span><span class="p">:</span> <span class="kd">function</span> <span class="nx">onConsumerIdentified</span><span class="p">(</span><span class="nx">consumerIdentifiedEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="c1">// consumerIdentifiedEvent.consumerProfileRef contains the reference</span>
                <span class="c1">// to the identified consumer which we need to pass on to the</span>
                <span class="c1">// Payment Order to initialize a personalized Payment Menu.</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">consumerIdentifiedEvent</span><span class="p">);</span>
            <span class="p">},</span>
            <span class="na">onShippingDetailsAvailable</span><span class="p">:</span> <span class="kd">function</span> <span class="nx">onShippingDetailsAvailable</span><span class="p">(</span><span class="nx">shippingDetailsAvailableEvent</span><span class="p">)</span> <span class="p">{</span>
                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">shippingDetailsAvailableEvent</span><span class="p">);</span>
            <span class="p">}</span>
        <span class="p">}).</span><span class="nx">open</span><span class="p">();</span>
    <span class="p">};</span>
    <span class="c1">// Appending the script to the head</span>
    <span class="kd">var</span> <span class="nx">head</span> <span class="o">=</span> <span class="nb">document</span><span class="p">.</span><span class="nx">getElementsByTagName</span><span class="p">(</span><span class="dl">'</span><span class="s1">head</span><span class="dl">'</span><span class="p">)[</span><span class="mi">0</span><span class="p">];</span>
    <span class="nx">head</span><span class="p">.</span><span class="nx">appendChild</span><span class="p">(</span><span class="nx">script</span><span class="p">);</span>
<span class="p">});</span>

<span class="c1">// Place in your own API endpoint here.</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">open</span><span class="p">(</span><span class="dl">'</span><span class="s1">POST</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">&lt;Your-Backend-Endpoint-Here&gt;</span><span class="dl">'</span><span class="p">,</span> <span class="kc">true</span><span class="p">);</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">setRequestHeader</span><span class="p">(</span><span class="dl">'</span><span class="s1">Content-Type</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">application/json; charset=utf-8</span><span class="dl">'</span><span class="p">);</span>
<span class="c1">// In this example we'll send in all of the information mentioned before,</span>
<span class="c1">// in the request to the endpoint.</span>
<span class="nx">request</span><span class="p">.</span><span class="nx">send</span><span class="p">(</span><span class="nx">JSON</span><span class="p">.</span><span class="nx">stringify</span><span class="p">({</span>
    <span class="na">operation</span><span class="p">:</span> <span class="dl">'</span><span class="s1">initiate-consumer-session</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">language</span><span class="p">:</span> <span class="dl">'</span><span class="s1">sv-SE</span><span class="dl">'</span><span class="p">,</span>
    <span class="na">shippingAddressRestrictedToCountryCodes</span><span class="p">:</span> <span class="p">[</span><span class="dl">'</span><span class="s1">NO</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">SE</span><span class="dl">'</span><span class="p">]</span>
<span class="p">}));</span>
</code></pre></div></div>

<div class="alert  alert-neutral">
    
        
            <i class="material-icons alert-icon">info</i>
        
    

    
        
            <p>Note that we add the script at the end of the body. This ensures that
every element (like the container <code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> elements) has loaded in before we try to
access them with our script.</p>
        
    
</div>

<p>With the scripts loading in after the entire page is loaded, we can access the
<code class="language-plaintext highlighter-rouge">&lt;div&gt;</code> container that the Checkin will be hosted in.
After that has all loaded, you should see something like this:</p>

<p class="text-center"><img src="/assets/img/checkout/your-information.png" alt="Consumer UI" width="564" height="293" /></p>

<p>As you can see, the payer’s information is pre-filled as provided by the
initial <code class="language-plaintext highlighter-rouge">POST</code>. With a <code class="language-plaintext highlighter-rouge">consumerProfileRef</code> safely tucked into our pocket,
the Checkin is complete and we can move on to <a href="payment-menu">Payment Menu</a>.</p>

<p>If a browser refresh is performed after the payer has checked in, the payment
menu must be shown even though <code class="language-plaintext highlighter-rouge">onConsumerIdentified</code> is not invoked.</p>

<p>Additional events during Checkin  can also be implemented
in the <code class="language-plaintext highlighter-rouge">configuration</code> object, such as <code class="language-plaintext highlighter-rouge">onConsumerIdentified</code>, <code class="language-plaintext highlighter-rouge">onShippingDetailsAvailable</code>and
<code class="language-plaintext highlighter-rouge">onBillingDetailsAvailable</code>. Read more about these in the
<a href="/checkout/other-features#checkin-events">Checkin events</a> section.</p>
    
      <h3 id="note-on-consumer-data">
        
        
          Note on consumer data <a href="#note-on-consumer-data" class="header-anchor"></a>
        
        
      </h3>

<p>During this stage some consumer data is stored.
Read more about our <a href="/resources/data-protection#paymentorder-consumer-data">Data Protection Policy</a> for details on which
information we store and its duration.</p>

<nav class="iterator d-flex">
    
        <a class="mr-auto btn btn-guiding" role="button" rel="prev" href="./">
            Back: Introduction
        </a>
    

    
        <a class="ml-auto btn btn-executive" role="button" rel="next" href="payment-menu">
            Next: Payment Menu
        </a>
    
</nav>
                                    
                                </div>

                                <div class="col-2 d-none d-lg-block">
                                    <nav class="doc-toc">
                                        <ul>
  <li class="toc-2"><a href="#introduction">Introduction</a></li>
  <li class="toc-2"><a href="#checkin-back-end">Checkin Back End</a></li>
  <li class="toc-2"><a href="#checkin-front-end">Checkin Front End</a></li>
</ul>

                                    </nav>
                                </div>
                            </div>
                        </div>
                    </main>
                </div>
            </div>

            <footer class="page-footer">
                <p class="page-footer-rights">© Swedbank Pay</p>
            </footer>
        </div>

        <script src="https://design.swedbankpay.com/v/4.3.0/scripts/dg.js"></script>
        <script src="/assets/js/prism.js" data-manual></script>
        <script src="/assets/js/swedbank-pay-design-guide-theme.js"></script>
        
        <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156582708-1"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-156582708-1');
</script>

        
    </body>

</html>